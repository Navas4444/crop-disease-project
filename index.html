<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Camera UI</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}

body {
    background: url("https://github.com/Navas4444/Crop-Disease-Backend/releases/download/Background-Images/crop_disease_bg.png")
                center / cover no-repeat fixed;
    overflow: hidden;
}

/* Camera container */
.camera-shell {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 260px;
    height: 360px;
    border-radius: 40px;
    overflow: hidden;
    background: rgba(0,0,0,0.25);
    backdrop-filter: blur(10px);
}

video, canvas {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* Bottom pill */
.pill {
    position: fixed;
    bottom: 24px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    padding: 12px 18px;
    border-radius: 999px;
    backdrop-filter: blur(14px);
    background: rgba(255,255,255,0.15);
}

.pill button {
    all: unset;
    cursor: pointer;
    padding: 0 10px;
}

.divider {
    width: 1px;
    height: 20px;
    background: rgba(255,255,255,0.5);
}
</style>
</head>

<body>

<div class="camera-shell">
    <video id="video" autoplay playsinline></video>
    <canvas id="canvas" hidden></canvas>
</div>

<div class="pill">
    <!-- Capture -->
    <button id="captureBtn">üì∏</button>
    <div class="divider"></div>
    <!-- Upload -->
    <button id="uploadBtn">‚¨ÜÔ∏è</button>
</div>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const captureBtn = document.getElementById("captureBtn");
const uploadBtn = document.getElementById("uploadBtn");

let capturedImage = null;

// Start camera
navigator.mediaDevices.getUserMedia({ video: true })
.then(stream => video.srcObject = stream)
.catch(err => alert("Camera error"));

// Capture photo
captureBtn.onclick = () => {
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    canvas.getContext("2d").drawImage(video, 0, 0);
    capturedImage = canvas.toDataURL("image/jpeg");
    alert("Photo captured ‚úÖ");
};

// Upload photo
uploadBtn.onclick = async () => {
    if (!capturedImage) {
        alert("Capture image first!");
        return;
    }

    const res = await fetch("http://127.0.0.1:5000/upload", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ image: capturedImage })
    });

    const data = await res.json();
    alert("Saved to laptop ‚úÖ");
};
</script>

</body>
</html>
